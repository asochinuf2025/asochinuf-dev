# GestiÃ³n de Planteles - Tab Interface

## User Interface Structure

The GestiÃ³n de Planteles section now has a tab-based interface for managing different aspects:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GestiÃ³n de Planteles                                            â”‚
â”‚ Administra los planteles deportivos                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ Tab Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚  ğŸ† Planteles  â”‚  ğŸ“Š CategorÃ­as y Ligas                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tab 1: Planteles (Default)

Shows the drag-and-drop interface for managing teams organized by divisions:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Search: ________________         [+ Nuevo Plantel]             â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ¥‡ Primera   â”‚ ğŸ¥ˆ Primera B â”‚ ğŸ¥‰ Segunda   â”‚ âš½ Tercera    â”‚  â”‚
â”‚  â”‚ DivisiÃ³n (2) â”‚        (1)   â”‚ DivisiÃ³n (1) â”‚ DivisiÃ³n (3) â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â‰¡ Colo-Colo â”‚ â‰¡ Universidadâ”‚ â‰¡ Huachipato â”‚ â‰¡ Ã‘ublense    â”‚  â”‚
â”‚  â”‚   [âœï¸][ğŸ—‘ï¸]  â”‚     Chile    â”‚              â”‚              â”‚  â”‚
â”‚  â”‚              â”‚   [âœï¸][ğŸ—‘ï¸]  â”‚   [âœï¸][ğŸ—‘ï¸]  â”‚   [âœï¸][ğŸ—‘ï¸]  â”‚  â”‚
â”‚  â”‚              â”‚              â”‚              â”‚              â”‚  â”‚
â”‚  â”‚ â‰¡ Universidadâ”‚              â”‚              â”‚              â”‚  â”‚
â”‚  â”‚   CatÃ³lica   â”‚              â”‚              â”‚              â”‚  â”‚
â”‚  â”‚   [âœï¸][ğŸ—‘ï¸]  â”‚              â”‚              â”‚              â”‚  â”‚
â”‚  â”‚              â”‚              â”‚              â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  [ğŸ’¾ Guardar Cambios]  [âŒ Descartar]     (Cambios pendientes)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Features:**
- Drag and drop planteles between divisions
- Create new planteles
- Edit plantel details (nombre, ciudad, regiÃ³n)
- Delete/deactivate planteles
- Search planteles by name
- Batch save changes or discard

---

### Tab 2: CategorÃ­as y Ligas

Two sub-tabs for managing categories and leagues with plantel assignments:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                  â”‚
â”‚  â”Œâ”€ CategorÃ­as Tab â”¬â”€ Ligas Tab â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                 â”‚                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”‚  Search: ___________________     [+ Nueva CategorÃ­a]            â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€ CategorÃ­as â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Nombre    â”‚ DescripciÃ³n      â”‚ Orden â”‚ Planteles â”‚ AcciÃ³n â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Liga       â”‚ FÃºtbol profesional     â”‚ 1  â”‚    5    â”‚ [ğŸ”—] â”‚ â”‚
â”‚  â”‚ Masculina  â”‚                        â”‚    â”‚         â”‚ [âœï¸] â”‚ â”‚
â”‚  â”‚ Adulta     â”‚                        â”‚    â”‚         â”‚ [ğŸ—‘ï¸] â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Liga       â”‚ CategorÃ­as menores     â”‚ 2  â”‚    8    â”‚ [ğŸ”—] â”‚ â”‚
â”‚  â”‚ Femenina   â”‚                        â”‚    â”‚         â”‚ [âœï¸] â”‚ â”‚
â”‚  â”‚            â”‚                        â”‚    â”‚         â”‚ [ğŸ—‘ï¸] â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Sub-tab A: CategorÃ­as

**Features:**
- View all categories (divisiones)
- See count of planteles assigned to each
- Create new category
- Edit category (nombre, descripciÃ³n, orden)
- Delete category
- **Link Planteles Button** - Opens modal to assign/unassign planteles

**Plantel Assignment Modal:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Asignar Planteles - Liga Femenina      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  â˜‘ Colo-Colo                            â”‚
â”‚  â˜ Universidad de Chile                 â”‚
â”‚  â˜‘ Universidad CatÃ³lica                 â”‚
â”‚  â˜ Huachipato                           â”‚
â”‚  â˜‘ Ã‘ublense                             â”‚
â”‚  ...                                     â”‚
â”‚                                          â”‚
â”‚  [Cancelar]              [Guardar]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Sub-tab B: Ligas

**Features:**
- View all ligas (leagues)
- Filter by category dropdown
- See count of measurement sessions for each liga
- Create new liga
- Edit liga (nombre, categorÃ­a, descripciÃ³n, orden)
- Delete liga
- Search ligas by name

---

## Data Flow Diagram

### Plantel Assignment Flow

```
Admin navigates to:
  Dashboard â†’ Gestion â†’ Planteles â†’ Tab: CategorÃ­as y Ligas

1. CategorÃ­as Tab:
   â”œâ”€ See all 6 categories
   â”œâ”€ Click "Link Planteles" for a category
   â”œâ”€ Modal opens with checkbox list of all planteles
   â”œâ”€ Admin checks/unchecks planteles
   â””â”€ Click "Guardar" to save assignments

2. Changes:
   â”œâ”€ POST /api/ligas/plantel/categoria/asignar
   â”‚  (for newly checked planteles)
   â””â”€ DELETE /api/ligas/plantel/:id/categoria/:id
      (for unchecked planteles)
```

### Liga Creation Flow

```
Admin in Ligas Tab:

1. Click "+ Nueva Liga"
2. Modal opens:
   â”œâ”€ Nombre: ___________
   â”œâ”€ CategorÃ­a: [Dropdown â–¼]
   â”œâ”€ DescripciÃ³n: ___________
   â””â”€ Orden: ____

3. Click "Crear"
4. POST /api/ligas
5. Liga added to list
```

### Excel Upload Flow (After Setup)

```
Nutricionista uploads Excel:

1. Dashboard â†’ Excel Tab
2. Select Plantel (team)
   â”œâ”€ API call: GET /api/ligas/plantel/{id}/categorias
   â””â”€ Shows only categories assigned to that plantel

3. Select CategorÃ­a (division)
   â”œâ”€ API call: GET /api/ligas/plantel/{plantel}/categoria/{cat}/ligas
   â””â”€ Shows only ligas for that category

4. Select Liga (specific league)
   â””â”€ Ready to upload

5. Upload Excel file
   â””â”€ Backend stores liga_id with session
```

---

## Key Implementation Details

### Component Hierarchy

```
GestionPlantelesSection
â”œâ”€ [activeTab state: 'planteles' | 'categorias-ligas']
â”œâ”€ When activeTab === 'planteles':
â”‚  â””â”€ Existing drag-drop interface (unchanged)
â”œâ”€ When activeTab === 'categorias-ligas':
â”‚  â””â”€ CategoriasLigasManager component
â”‚     â”œâ”€ [activeTab state: 'categorias' | 'ligas']
â”‚     â”œâ”€ CategorÃ­as tab with modal system
â”‚     â””â”€ Ligas tab with filter and modal system
```

### API Endpoints Used

**In CategorÃ­as Tab:**
```
GET    /api/ligas/categorias/todas                    - List categories
GET    /api/planteles                                 - List planteles (for assignment)
POST   /api/ligas/plantel/categoria/asignar           - Assign plantel to category
DELETE /api/ligas/plantel/{id}/categoria/{id}        - Unassign plantel
```

**In Ligas Tab:**
```
GET    /api/ligas                                     - List all ligas
GET    /api/ligas/categoria/{id}                      - Filter ligas by category
POST   /api/ligas                                     - Create new liga
PUT    /api/ligas/{id}                               - Update liga
DELETE /api/ligas/{id}                               - Delete liga
```

---

## User Experience

### Admin Workflow

1. **Initial Setup (one-time):**
   - Run database setup: `npm run db:setup-ligas`
   - Navigate to GestiÃ³n â†’ Planteles â†’ CategorÃ­as y Ligas
   - Assign planteles to categories

2. **Daily Use:**
   - Create/manage ligas in Ligas tab
   - Assign new planteles in CategorÃ­as tab
   - Manage plantel details in Planteles tab

### Nutritionist Workflow

1. **Excel Upload:**
   - Navigate to Dashboard â†’ Excel
   - Select Plantel â†’ Category â†’ Liga (3-step dependent selection)
   - Upload file (validation ensures liga is selected)
   - See success message with liga name

---

## Responsive Design

- Desktop: Two-column tab interface
- Tablet: Single column with scrollable tables
- Mobile: Stacked layout with full-width buttons
- Dark Mode: Full support with color theme
- Animations: Smooth transitions between tabs

---
